the debug result now shows that when icache tried to read from flash at 0x3000040,it never gets rlast reply and dead locked here
答案是,没发last信号导致soc一直认为没写完，同时复位可能也有影响
(npc) c
ysyx:25040129
======= Running MicroBench [input *train*] =======
[qsort] Quick sort: * Passed.
  min time: 166108.829 ms [0]
[queen] Queen placement: * Passed.
  min time: 618847.240 ms [0]
[bf] Brainf**k interpreter: * Passed.
  min time: 238858.773 ms [0]
[fib] Fibonacci number: * Passed.
  min time: 2402716.157 ms [0]
[sieve] Eratosthenes sieve: * Passed.
  min time: 158523.655 ms [0]
[15pz] A* 15-puzzle search: * Passed.
  min time: 423769.458 ms [0]
[dinic] Dinic's maxflow algorithm: * Passed.
  min time: 252898.949 ms [0]
[lzip] Lzip compression: * Passed.
  min time: 217879.670 ms [0]
[ssort] Suffix sort: * Passed.
  min time: 291343.926 ms [0]
[md5] MD5 digest: * Passed.
  min time: 394309.692 ms [0]
==================================================
MicroBench PASS
Scored time: 5165256.349 ms
Total  time: 5621038.040 ms
HIT GOOD TRAP
total inst:             195317536, total cycles:        5651711008, per  28.936014 cycles
fetch act count:        195317536, fetch cycle:         1778148726, per   9.103887 cycles
execute act count:      195317536, execute cycle:        195317536, per   1.000000 cycles
load act count:          15620692, load cycle:          2267370952, per 145.151761 cycles
store act count:          7179103, store cycle:          847720981, per 118.081741 cycles
calculate count:        115926721, calculate cycle:     1273555273, per  10.985865 cycles
load/store inst count:   22799795, load/store cycle:    3485729275, per 152.884238 cycles
branch inst count:       56591018, branch cycle:         892422778, per  15.769689 cycles
csr inst count:                 2, csr cycle:                   66, per  33.000000 cycles
icache hit count:       168881394, icache hit cycle:     337762788, per   2.000000 cycles
icache miss count:       26436142, icache miss cycle:   1245068402, per  47.097205 cycles
icache aver count:      195317536, icache aver cycle:   1582831190, per   8.103887 cycles
icache miss rate:      %     13.53
make[1]: Leaving directory '/home/pglzjz/ysyx-workbench/npc'使用psram作为栈
pglzjz@pglzjz-virtual-machine:~/ysyx-workbench/am-kernels/benchmarks/microbench$ make run mainargs=train 
# Building microbench-run [riscv32e-ysyxsoc]
# Building am-archive [riscv32e-ysyxsoc]
# Building klib-archive [riscv32e-ysyxsoc]
# Creating image [riscv32e-ysyxsoc]
+ LD -> build/microbench-riscv32e-ysyxsoc.elf
+ OBJCOPY -> build/microbench-riscv32e-ysyxsoc.bin
mainargs=train
make -C /home/pglzjz/ysyx-workbench/npc ISA=riscv32e run ARGS="" IMG=/home/pglzjz/ysyx-workbench/am-kernels/benchmarks/microbench/build/microbench-riscv32e-ysyxsoc.bin
make[1]: Entering directory '/home/pglzjz/ysyx-workbench/npc'
# DO NOT REMOVE THIS LINE!!!
verilator --cc --exe --build -j  0 -O3 -Wwarn-LATCH -Wwarn-MULTIDRIVEN --trace --top-module ysyxSoCFull --Mdir build/obj_dir /home/pglzjz/ysyx-workbench/npc/platform/simulation.v /home/pglzjz/ysyx-workbench/npc/vsrc/*.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/spi/rtl/spi_top_apb.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/spi/rtl/spi_top.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/spi/rtl/spi_clgen.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/spi/rtl/spi_defines.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/spi/rtl/spi_shift.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/uart_tfifo.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/uart_receiver.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/uart_transmitter.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/uart_sync_flops.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/uart_rfifo.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/raminfr.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/uart_defines.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/uart_regs.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl/uart_top_apb.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/gpio/gpio_top_apb.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/psram/psram.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/psram/efabless/EF_PSRAM_CTRL.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/psram/efabless/EF_PSRAM_CTRL_wb.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/psram/psram_top_apb.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/amba/apb_delayer.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/amba/axi4_delayer.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/ps2/ps2_top_apb.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/vga/vga_top_apb.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/sdram/sdram.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/sdram/sdram_top_apb.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/sdram/core_sdram_axi4/sdram_axi_core.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/sdram/core_sdram_axi4/sdram_axi_pmem.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/sdram/core_sdram_axi4/sdram_axi.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/sdram/sdram_top_axi.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/bitrev/bitrev.v /home/pglzjz/ysyx-workbench/ysyxSoC/perip/flash/flash.v /home/pglzjz/ysyx-workbench/ysyxSoC/build/*.v /home/pglzjz/ysyx-workbench/npc/csrc/*.cpp /home/pglzjz/ysyx-workbench/npc/csrc/*.c /home/pglzjz/ysyx-workbench/npc/build/auto_bind.cpp /home/pglzjz/ysyx-workbench/nvboard/build/nvboard.a \
-LDFLAGS -lSDL2 -LDFLAGS -lSDL2_image -LDFLAGS -lSDL2_ttf --LDFLAGS "-lreadline" -CFLAGS -MMD -CFLAGS -O3 -CFLAGS -I/usr/include/SDL2 -CFLAGS -D_REENTRANT --CFLAGS "-I ~/ysyx-workbench/nemu/tools/capstone/repo/include" --CFLAGS "-I /home/pglzjz/ysyx-workbench/nvboard/usr/include" \
-I/home/pglzjz/ysyx-workbench/ysyxSoC/perip/uart16550/rtl -I/home/pglzjz/ysyx-workbench/ysyxSoC/perip/spi/rtl -I/home/pglzjz/ysyx-workbench/npc/vsrc \
--timescale "1ns/1ns" --no-timing --autoflush
make[2]: Entering directory '/home/pglzjz/ysyx-workbench/npc/build/obj_dir'
make[2]: Nothing to be done for 'default'.
make[2]: Leaving directory '/home/pglzjz/ysyx-workbench/npc/build/obj_dir'
- V e r i l a t i o n   R e p o r t: Verilator 5.035 devel rev v5.034-24-g27d3eb5b7
- Verilator: Built from 0.000 MB sources in 0 modules, into 0.000 MB in 0 C++ files needing 0.000 MB
- Verilator: Walltime 0.015 s (elab=0.000, cvt=0.000, bld=0.014); cpu 0.001 s on 4 threads; alloced 18.695 MB
/home/pglzjz/ysyx-workbench/npc/build/obj_dir/VysyxSoCFull --log=/home/pglzjz/ysyx-workbench/npc/build/npc-log.txt --elf=/home/pglzjz/ysyx-workbench/am-kernels/benchmarks/microbench/build/microbench-riscv32e-ysyxsoc.elf  /home/pglzjz/ysyx-workbench/am-kernels/benchmarks/microbench/build/microbench-riscv32e-ysyxsoc.bin
bind UART_TX 0x7bdacb0d2128 to 0x7bdacb0d2128
The image is /home/pglzjz/ysyx-workbench/am-kernels/benchmarks/microbench/build/microbench-riscv32e-ysyxsoc.bin, size = 31296
Welcome to NPC!
(npc) c
ysyx:25040129
======= Running MicroBench [input *train*] =======
[qsort] Quick sort: * Passed.
  min time: 124460.795 ms [0]
[queen] Queen placement: * Passed.
  min time: 132980.818 ms [0]
[bf] Brainf**k interpreter: * Passed.
  min time: 238811.697 ms [0]
[fib] Fibonacci number: * Passed.
  min time: 1194845.503 ms [0]
[sieve] Eratosthenes sieve: * Passed.
  min time: 158075.573 ms [0]
[15pz] A* 15-puzzle search: * Passed.
  min time: 136849.483 ms [0]
[dinic] Dinic's maxflow algorithm: * Passed.
  min time: 100354.315 ms [0]
[lzip] Lzip compression: * Passed.
  min time: 89394.122 ms [0]
[ssort] Suffix sort: * Passed.
  min time: 144283.124 ms [0]
[md5] MD5 digest: * Passed.
  min time: 178662.090 ms [0]
==================================================
MicroBench PASS
Scored time: 2498717.520 ms
Total  time: 2916902.611 ms
HIT GOOD TRAP
total inst:             195313907, total cycles:        2947248200, per  15.089802 cycles
fetch act count:        195313907, fetch cycle:         1739473207, per   8.906039 cycles
execute act count:      195313907, execute cycle:        195313907, per   1.000000 cycles
load act count:          15620560, load cycle:           342586313, per  21.931756 cycles
store act count:          7178976, store cycle:          106732588, per  14.867383 cycles
calculate count:        115923654, calculate cycle:     1260329902, per  10.872068 cycles
load/store inst count:   22799536, load/store cycle:     797344997, per  34.971984 cycles
branch inst count:       56590715, branch cycle:         889569634, per  15.719357 cycles
csr inst count:                 2, csr cycle:                   51, per  25.500000 cycles
icache hit count:       168878652, icache hit cycle:     337757304, per   2.000000 cycles
icache miss count:       26435255, icache miss cycle:   1206401996, per  45.636102 cycles
icache aver count:      195313907, icache aver cycle:   1544159300, per   7.906039 cycles
icache miss rate:      %     13.53
make[1]: Leaving directory '/home/pglzjz/ysyx-workbench/npc'(sram作为栈的性能表现)